<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Intonation Toy</title>
    <link data-trunk rel="copy-file" href="static/style.css" />
    <link rel="stylesheet" href="style.css" />
    <link data-trunk rel="copy-file" href="static/audio-processor.js" />
    <link data-trunk rel="rust" data-wasm-opt="4" />
  </head>
  <body class="app-body">
    <div id="sidebar" class="app-sidebar">
      <h1 class="sidebar-header">Intonation Toy</h1>
      <div id="main-scene-ui-container" class="ui-container">
        <!-- Root Note Section -->
        <div class="subsection-header">Root Note</div>
        <div class="control-row">
          <button id="root-note-minus" class="small-button">-</button>
          <span id="root-note-display" class="root-note-display">A3</span>
          <button id="root-note-plus" class="small-button">+</button>
        </div>
        <div class="tuning-fork-controls">
          <label for="tuning-fork-volume" class="volume-label">Volume (dB)</label>
          <input id="tuning-fork-volume" type="range" min="0" max="100" value="0" />
          <span id="tuning-fork-volume-display" class="volume-display">-âˆž dB</span>
        </div>

        <!-- Tuning System Section -->
        <div class="subsection-header">Tuning System</div>
        <div class="control-row">
          <select id="tuning-system-select" class="control-select">
            <option value="equal">Equal Temperament</option>
            <option value="just">Just Intonation</option>
          </select>
        </div>

        <!-- Scale Section -->
        <div class="subsection-header">Scale</div>
        <div class="control-row">
          <select id="scale-select" class="control-select">
            <option value="chromatic" selected="true">Chromatic</option>
            <option value="major">Major</option>
            <option value="minor">Minor</option>
            <option value="major_pentatonic">Major Pentatonic</option>
            <option value="minor_pentatonic">Minor Pentatonic</option>
          </select>
        </div>

        <!-- About Section -->
        <div class="about-section">
          <div class="about-header">About</div>
          <div class="about-content">
            <p class="about-text"><strong>Intonation Toy</strong> is a real-time pitch analysis and visualization tool. It helps you explore musical intonation by analyzing audio input and displaying the relationship between detected pitches and your selected root note.</p>
            
            <h3>Quick Guide</h3>
            <ul class="about-list">
              <li><strong>Root Note:</strong> Use +/- buttons to adjust the tonic pitch</li>
              <li><strong>Tuning Fork:</strong> Adjust volume of the root note reference tone with slider</li>
              <li><strong>Tuning System:</strong> Choose between Equal Temperament or Just Intonation</li>
              <li><strong>Scale:</strong> Select the musical scale for pitch visualization</li>
              <li><strong>Microphone:</strong> Grant permission when prompted to analyze live audio</li>
            </ul>
            
            <h3>Browser Requirements</h3>
            <p class="about-text">Works best in modern browsers with WebAssembly and Web Audio API support. Chrome, Firefox, Safari, and Edge are recommended.</p>
          </div>
        </div>
      </div>
    </div>
    <main id="canvas-container" class="app-canvas-container">
      <canvas id="three-d-canvas"></canvas>
    </main>

    <!-- Error Message Overlay -->
    <div id="error-message-overlay" class="error-overlay error-overlay-hidden">
      <div class="error-panel">
        <h2 id="error-title" class="error-title"></h2>
        <p id="error-details" class="error-details"></p>
      </div>
    </div>

    <!-- First Click Permission Overlay -->
    <div class="first-click-overlay first-click-overlay-hidden">
      <div id="permission-panel" class="first-click-panel">
        <h2 class="first-click-title">Intonation Toy</h2>
        <div class="first-click-description">Click anywhere to start<br><small class="permission-note">(Microphone permission will be requested)</small></div>
      </div>
    </div>
    <!-- Trunk will inject the JS/WASM for you -->
  </body>
</html>